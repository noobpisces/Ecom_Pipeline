[2025-09-22T07:58:15.864+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-09-22T07:58:16.128+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dbt_staging.dbt_ecom.stg_orders.test scheduled__2025-09-21T00:00:00+00:00 [queued]>
[2025-09-22T07:58:16.142+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dbt_staging.dbt_ecom.stg_orders.test scheduled__2025-09-21T00:00:00+00:00 [queued]>
[2025-09-22T07:58:16.145+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-09-22T07:58:16.179+0000] {taskinstance.py:2330} INFO - Executing <Task(DbtTestVirtualenvOperator): dbt_ecom.stg_orders.test> on 2025-09-21 00:00:00+00:00
[2025-09-22T07:58:16.186+0000] {standard_task_runner.py:64} INFO - Started process 1057 to run task
[2025-09-22T07:58:16.190+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'dbt_staging', 'dbt_ecom.stg_orders.test', 'scheduled__2025-09-21T00:00:00+00:00', '--job-id', '647', '--raw', '--subdir', 'DAGS_FOLDER/dbt_staging.py', '--cfg-path', '/tmp/tmp86rmsibl']
[2025-09-22T07:58:16.193+0000] {standard_task_runner.py:91} INFO - Job 647: Subtask dbt_ecom.stg_orders.test
[2025-09-22T07:58:16.389+0000] {task_command.py:426} INFO - Running <TaskInstance: dbt_staging.dbt_ecom.stg_orders.test scheduled__2025-09-21T00:00:00+00:00 [running]> on host e95bde6b8d07
[2025-09-22T07:58:16.927+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='dbt_staging' AIRFLOW_CTX_TASK_ID='dbt_ecom.stg_orders.test' AIRFLOW_CTX_EXECUTION_DATE='2025-09-21T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-21T00:00:00+00:00'
[2025-09-22T07:58:16.929+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-09-22T07:58:16.945+0000] {baseoperator.py:400} WARNING - DbtTestVirtualenvOperator.execute cannot be called outside TaskInstance!
[2025-09-22T07:58:16.946+0000] {virtualenv.py:120} INFO - Checking if the virtualenv lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock exists
[2025-09-22T07:58:16.946+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:16.947+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:16.947+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:17.949+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:17.950+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:17.950+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:18.952+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:18.953+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:18.953+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:19.955+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:19.956+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:19.956+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:20.958+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:20.958+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:20.959+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:21.960+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:21.961+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:21.962+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:22.965+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:22.967+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:22.968+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:23.970+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:23.971+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:23.972+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:24.974+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:24.975+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:24.975+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:25.977+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:25.978+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:25.979+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:26.980+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:26.982+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:26.982+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:27.983+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:27.985+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:27.987+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:28.990+0000] {virtualenv.py:178} INFO - Checking for running process with PID 948
[2025-09-22T07:58:28.993+0000] {virtualenv.py:181} INFO - Process 948 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:28.993+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:29.995+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:29.996+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:29.997+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:30.999+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:31.000+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:31.000+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:32.002+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:32.003+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:32.003+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:33.004+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:33.005+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:33.006+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:34.007+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:34.008+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:34.009+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:35.010+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:35.011+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:35.011+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:36.013+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:36.015+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:36.016+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:37.018+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:37.020+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:37.022+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:38.025+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:38.026+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:38.027+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:39.029+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:39.030+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:39.031+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:40.033+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:40.034+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:40.035+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:41.036+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:41.037+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:41.037+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:42.039+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:42.039+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:42.040+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:43.040+0000] {virtualenv.py:178} INFO - Checking for running process with PID 1056
[2025-09-22T07:58:43.041+0000] {virtualenv.py:181} INFO - Process 1056 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T07:58:43.042+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T07:58:44.044+0000] {virtualenv.py:126} INFO - Acquiring the virtualenv lock
[2025-09-22T07:58:44.045+0000] {virtualenv.py:195} INFO - Acquiring lock at /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock with pid 1057
[2025-09-22T07:58:44.046+0000] {virtualenv.py:153} INFO - Creating or updating the virtualenv at `/tmp/cosmos_venv_ecom
[2025-09-22T07:58:44.047+0000] {process_utils.py:183} INFO - Executing cmd: /home/***/.local/bin/python -m virtualenv /tmp/cosmos_venv_ecom --python=python3
[2025-09-22T07:58:44.049+0000] {process_utils.py:187} INFO - Output:
[2025-09-22T07:58:45.119+0000] {process_utils.py:191} INFO - created virtual environment CPython3.10.14.final.0-64 in 403ms
[2025-09-22T07:58:45.119+0000] {process_utils.py:191} INFO -   creator CPython3Posix(dest=/tmp/cosmos_venv_ecom, clear=False, no_vcs_ignore=False, global=False)
[2025-09-22T07:58:45.120+0000] {process_utils.py:191} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/***/.local/share/virtualenv)
[2025-09-22T07:58:45.121+0000] {process_utils.py:191} INFO -     added seed packages: MarkupSafe==3.0.2, PyYAML==6.0.2, agate==1.9.1, annotated_types==0.7.0, attrs==25.3.0, babel==2.17.0, certifi==2025.8.3, charset_normalizer==3.4.3, click==8.2.1, clickhouse_connect==0.8.18, clickhouse_driver==0.2.9, colorama==0.4.6, daff==1.4.2, dbt_adapters==1.16.7, dbt_clickhouse==1.9.3, dbt_common==1.30.0, dbt_core==1.10.11, dbt_extractor==0.6.0, dbt_protos==1.0.375, dbt_semantic_interfaces==0.9.0, deepdiff==8.6.1, idna==3.10, importlib_metadata==8.7.0, isodate==0.6.1, jinja2==3.1.6, jsonschema==4.25.1, jsonschema_specifications==2025.9.1, leather==0.4.0, lz4==4.4.4, mashumaro==3.14, more_itertools==10.8.0, msgpack==1.1.1, networkx==3.4.2, orderly_set==5.5.0, packaging==25.0, parsedatetime==2.6, pathspec==0.12.1, pip==25.2, protobuf==6.32.1, pydantic==2.11.7, pydantic_core==2.33.2, python_dateutil==2.9.0.post0, python_slugify==8.0.4, pytimeparse==1.1.8, pytz==2025.2, referencing==0.36.2, requests==2.32.5, rpds_py==0.27.1, setuptools==80.9.0, six==1.17.0, snowplow_tracker==1.1.0, sqlparse==0.5.3, text_unidecode==1.3, typing_extensions==4.15.0, typing_inspection==0.4.1, tzlocal==5.3.1, urllib3==2.5.0, wheel==0.45.1, zipp==3.23.0, zstandard==0.24.0
[2025-09-22T07:58:45.122+0000] {process_utils.py:191} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2025-09-22T07:58:45.170+0000] {process_utils.py:183} INFO - Executing cmd: /tmp/cosmos_venv_ecom/bin/pip install dbt-clickhouse
[2025-09-22T07:58:45.171+0000] {process_utils.py:187} INFO - Output:
[2025-09-22T07:58:46.213+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-clickhouse in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (1.9.3)
[2025-09-22T07:58:46.214+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-core>=1.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (1.10.11)
[2025-09-22T07:58:46.215+0000] {process_utils.py:191} INFO - Requirement already satisfied: clickhouse-connect>=0.6.22 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (0.8.18)
[2025-09-22T07:58:46.216+0000] {process_utils.py:191} INFO - Requirement already satisfied: clickhouse-driver>=0.2.6 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (0.2.9)
[2025-09-22T07:58:46.217+0000] {process_utils.py:191} INFO - Requirement already satisfied: setuptools>=0.69 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (80.9.0)
[2025-09-22T07:58:46.218+0000] {process_utils.py:191} INFO - Requirement already satisfied: certifi in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (2025.8.3)
[2025-09-22T07:58:46.219+0000] {process_utils.py:191} INFO - Requirement already satisfied: urllib3>=1.26 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (2.5.0)
[2025-09-22T07:58:46.220+0000] {process_utils.py:191} INFO - Requirement already satisfied: pytz in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (2025.2)
[2025-09-22T07:58:46.220+0000] {process_utils.py:191} INFO - Requirement already satisfied: zstandard in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (0.24.0)
[2025-09-22T07:58:46.221+0000] {process_utils.py:191} INFO - Requirement already satisfied: lz4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (4.4.4)
[2025-09-22T07:58:46.223+0000] {process_utils.py:191} INFO - Requirement already satisfied: tzlocal in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-driver>=0.2.6->dbt-clickhouse) (5.3.1)
[2025-09-22T07:58:46.226+0000] {process_utils.py:191} INFO - Requirement already satisfied: agate<1.10,>=1.7.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.9.1)
[2025-09-22T07:58:46.227+0000] {process_utils.py:191} INFO - Requirement already satisfied: Jinja2<4,>=3.1.3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (3.1.6)
[2025-09-22T07:58:46.228+0000] {process_utils.py:191} INFO - Requirement already satisfied: mashumaro<3.15,>=3.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from mashumaro[msgpack]<3.15,>=3.9->dbt-core>=1.9->dbt-clickhouse) (3.14)
[2025-09-22T07:58:46.229+0000] {process_utils.py:191} INFO - Requirement already satisfied: click<9.0,>=8.0.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (8.2.1)
[2025-09-22T07:58:46.229+0000] {process_utils.py:191} INFO - Requirement already satisfied: jsonschema<5.0,>=4.19.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (4.25.1)
[2025-09-22T07:58:46.230+0000] {process_utils.py:191} INFO - Requirement already satisfied: networkx<4.0,>=2.3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (3.4.2)
[2025-09-22T07:58:46.231+0000] {process_utils.py:191} INFO - Requirement already satisfied: protobuf<7.0,>=6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (6.32.1)
[2025-09-22T07:58:46.232+0000] {process_utils.py:191} INFO - Requirement already satisfied: requests<3.0.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (2.32.5)
[2025-09-22T07:58:46.232+0000] {process_utils.py:191} INFO - Requirement already satisfied: snowplow-tracker<2.0,>=1.0.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.1.0)
[2025-09-22T07:58:46.233+0000] {process_utils.py:191} INFO - Requirement already satisfied: pathspec<0.13,>=0.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.12.1)
[2025-09-22T07:58:46.234+0000] {process_utils.py:191} INFO - Requirement already satisfied: sqlparse<0.6.0,>=0.5.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.5.3)
[2025-09-22T07:58:46.234+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-extractor<=0.6,>=0.5.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.6.0)
[2025-09-22T07:58:46.235+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-semantic-interfaces<0.10,>=0.9.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.9.0)
[2025-09-22T07:58:46.236+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-common<2.0,>=1.27.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.30.0)
[2025-09-22T07:58:46.236+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-adapters<2.0,>=1.15.5 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.16.7)
[2025-09-22T07:58:46.237+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-protos<2.0,>=1.0.346 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.0.375)
[2025-09-22T07:58:46.238+0000] {process_utils.py:191} INFO - Requirement already satisfied: pydantic<3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (2.11.7)
[2025-09-22T07:58:46.238+0000] {process_utils.py:191} INFO - Requirement already satisfied: packaging>20.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (25.0)
[2025-09-22T07:58:46.239+0000] {process_utils.py:191} INFO - Requirement already satisfied: pyyaml>=6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (6.0.2)
[2025-09-22T07:58:46.240+0000] {process_utils.py:191} INFO - Requirement already satisfied: daff>=1.3.46 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.4.2)
[2025-09-22T07:58:46.240+0000] {process_utils.py:191} INFO - Requirement already satisfied: typing-extensions>=4.4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (4.15.0)
[2025-09-22T07:58:46.241+0000] {process_utils.py:191} INFO - Requirement already satisfied: Babel>=2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (2.17.0)
[2025-09-22T07:58:46.242+0000] {process_utils.py:191} INFO - Requirement already satisfied: isodate>=0.5.4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (0.6.1)
[2025-09-22T07:58:46.243+0000] {process_utils.py:191} INFO - Requirement already satisfied: leather>=0.3.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (0.4.0)
[2025-09-22T07:58:46.244+0000] {process_utils.py:191} INFO - Requirement already satisfied: parsedatetime!=2.5,>=2.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (2.6)
[2025-09-22T07:58:46.244+0000] {process_utils.py:191} INFO - Requirement already satisfied: python-slugify>=1.2.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (8.0.4)
[2025-09-22T07:58:46.245+0000] {process_utils.py:191} INFO - Requirement already satisfied: pytimeparse>=1.1.5 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (1.1.8)
[2025-09-22T07:58:46.258+0000] {process_utils.py:191} INFO - Requirement already satisfied: colorama<0.5,>=0.3.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (0.4.6)
[2025-09-22T07:58:46.259+0000] {process_utils.py:191} INFO - Requirement already satisfied: deepdiff<9.0,>=7.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (8.6.1)
[2025-09-22T07:58:46.262+0000] {process_utils.py:191} INFO - Requirement already satisfied: python-dateutil<3.0,>=2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (2.9.0.post0)
[2025-09-22T07:58:46.268+0000] {process_utils.py:191} INFO - Requirement already satisfied: importlib-metadata<9,>=6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-semantic-interfaces<0.10,>=0.9.0->dbt-core>=1.9->dbt-clickhouse) (8.7.0)
[2025-09-22T07:58:46.269+0000] {process_utils.py:191} INFO - Requirement already satisfied: more-itertools<11.0,>=8.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-semantic-interfaces<0.10,>=0.9.0->dbt-core>=1.9->dbt-clickhouse) (10.8.0)
[2025-09-22T07:58:46.278+0000] {process_utils.py:191} INFO - Requirement already satisfied: orderly-set<6,>=5.4.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from deepdiff<9.0,>=7.0->dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (5.5.0)
[2025-09-22T07:58:46.284+0000] {process_utils.py:191} INFO - Requirement already satisfied: zipp>=3.20 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from importlib-metadata<9,>=6.0->dbt-semantic-interfaces<0.10,>=0.9.0->dbt-core>=1.9->dbt-clickhouse) (3.23.0)
[2025-09-22T07:58:46.287+0000] {process_utils.py:191} INFO - Requirement already satisfied: six in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from isodate>=0.5.4->agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (1.17.0)
[2025-09-22T07:58:46.289+0000] {process_utils.py:191} INFO - Requirement already satisfied: MarkupSafe>=2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from Jinja2<4,>=3.1.3->dbt-core>=1.9->dbt-clickhouse) (3.0.2)
[2025-09-22T07:58:46.294+0000] {process_utils.py:191} INFO - Requirement already satisfied: attrs>=22.2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (25.3.0)
[2025-09-22T07:58:46.295+0000] {process_utils.py:191} INFO - Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (2025.9.1)
[2025-09-22T07:58:46.296+0000] {process_utils.py:191} INFO - Requirement already satisfied: referencing>=0.28.4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (0.36.2)
[2025-09-22T07:58:46.297+0000] {process_utils.py:191} INFO - Requirement already satisfied: rpds-py>=0.7.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (0.27.1)
[2025-09-22T07:58:46.306+0000] {process_utils.py:191} INFO - Requirement already satisfied: msgpack>=0.5.6 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from mashumaro[msgpack]<3.15,>=3.9->dbt-core>=1.9->dbt-clickhouse) (1.1.1)
[2025-09-22T07:58:46.326+0000] {process_utils.py:191} INFO - Requirement already satisfied: annotated-types>=0.6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from pydantic<3->dbt-core>=1.9->dbt-clickhouse) (0.7.0)
[2025-09-22T07:58:46.327+0000] {process_utils.py:191} INFO - Requirement already satisfied: pydantic-core==2.33.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from pydantic<3->dbt-core>=1.9->dbt-clickhouse) (2.33.2)
[2025-09-22T07:58:46.329+0000] {process_utils.py:191} INFO - Requirement already satisfied: typing-inspection>=0.4.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from pydantic<3->dbt-core>=1.9->dbt-clickhouse) (0.4.1)
[2025-09-22T07:58:46.336+0000] {process_utils.py:191} INFO - Requirement already satisfied: charset_normalizer<4,>=2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from requests<3.0.0->dbt-core>=1.9->dbt-clickhouse) (3.4.3)
[2025-09-22T07:58:46.337+0000] {process_utils.py:191} INFO - Requirement already satisfied: idna<4,>=2.5 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from requests<3.0.0->dbt-core>=1.9->dbt-clickhouse) (3.10)
[2025-09-22T07:58:46.387+0000] {process_utils.py:191} INFO - Requirement already satisfied: text-unidecode>=1.3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from python-slugify>=1.2.1->agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (1.3)
[2025-09-22T07:58:46.509+0000] {local.py:470} INFO - Cloning project to writable temp directory /tmp/tmp_kjrmhwf from /opt/airflow/dags/dbt/ecom_staging
[2025-09-22T07:58:46.537+0000] {local.py:490} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/dbt_staging__dbt_ecom/target/partial_parse.msgpack
[2025-09-22T07:58:46.553+0000] {config.py:362} INFO - Using user-supplied profiles.yml at /opt/airflow/dags/dbt/profiles.yml
[2025-09-22T07:58:46.572+0000] {virtualenv.py:99} INFO - Using Python binary from virtualenv: /tmp/cosmos_venv_ecom/bin/python
[2025-09-22T07:58:46.573+0000] {local.py:434} INFO - Trying to run the command:
 ['/tmp/cosmos_venv_ecom/bin/dbt', 'deps', '--project-dir', '/tmp/tmp_kjrmhwf', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
From /tmp/tmp_kjrmhwf
[2025-09-22T07:58:46.574+0000] {subprocess.py:56} INFO - Tmp dir root location: 
 /tmp
[2025-09-22T07:58:46.575+0000] {subprocess.py:69} INFO - Running command: ['/tmp/cosmos_venv_ecom/bin/dbt', 'deps', '--project-dir', '/tmp/tmp_kjrmhwf', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
[2025-09-22T07:58:46.591+0000] {subprocess.py:80} INFO - Command output:
[2025-09-22T07:58:48.553+0000] {subprocess.py:90} INFO - [0m07:58:48  Running with dbt=1.10.11
[2025-09-22T07:58:49.567+0000] {subprocess.py:90} INFO - [0m07:58:49  Installing dbt-labs/dbt_utils
[2025-09-22T07:58:50.288+0000] {subprocess.py:90} INFO - [0m07:58:50  Installed from version 1.3.0
[2025-09-22T07:58:50.289+0000] {subprocess.py:90} INFO - [0m07:58:50  Updated version available: 1.3.1
[2025-09-22T07:58:50.290+0000] {subprocess.py:90} INFO - [0m07:58:50
[2025-09-22T07:58:50.290+0000] {subprocess.py:90} INFO - [0m07:58:50  Updates available for packages: ['dbt-labs/dbt_utils']
[2025-09-22T07:58:50.290+0000] {subprocess.py:90} INFO - Update your versions in packages.yml, then run dbt deps
[2025-09-22T07:58:51.952+0000] {subprocess.py:94} INFO - Command exited with return code 0
[2025-09-22T07:58:51.953+0000] {local.py:441} INFO - Update your versions in packages.yml, then run dbt deps
[2025-09-22T07:58:51.954+0000] {virtualenv.py:99} INFO - Using Python binary from virtualenv: /tmp/cosmos_venv_ecom/bin/python
[2025-09-22T07:58:51.955+0000] {local.py:434} INFO - Trying to run the command:
 ['/tmp/cosmos_venv_ecom/bin/dbt', 'test', '--models', 'stg_orders', '--project-dir', '/tmp/tmp_kjrmhwf', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
From /tmp/tmp_kjrmhwf
[2025-09-22T07:58:51.956+0000] {subprocess.py:56} INFO - Tmp dir root location: 
 /tmp
[2025-09-22T07:58:51.957+0000] {subprocess.py:69} INFO - Running command: ['/tmp/cosmos_venv_ecom/bin/dbt', 'test', '--models', 'stg_orders', '--project-dir', '/tmp/tmp_kjrmhwf', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
[2025-09-22T07:58:51.968+0000] {subprocess.py:80} INFO - Command output:
[2025-09-22T07:58:53.747+0000] {subprocess.py:90} INFO - [0m07:58:53  Running with dbt=1.10.11
[2025-09-22T07:58:53.749+0000] {subprocess.py:90} INFO - [0m07:58:53  [[33mWARNING[0m]: Deprecated functionality
[2025-09-22T07:58:53.750+0000] {subprocess.py:90} INFO - Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
[2025-09-22T07:58:53.751+0000] {subprocess.py:90} INFO - `-s`.
[2025-09-22T07:58:54.044+0000] {subprocess.py:90} INFO - [0m07:58:54  Registered adapter: clickhouse=1.9.3
[2025-09-22T07:58:54.740+0000] {subprocess.py:90} INFO - [0m07:58:54  Found 8 models, 47 data tests, 8 sources, 597 macros
[2025-09-22T07:58:54.744+0000] {subprocess.py:90} INFO - [0m07:58:54
[2025-09-22T07:58:54.745+0000] {subprocess.py:90} INFO - [0m07:58:54  Concurrency: 4 threads (target='dev')
[2025-09-22T07:58:54.746+0000] {subprocess.py:90} INFO - [0m07:58:54
[2025-09-22T07:58:54.881+0000] {subprocess.py:90} INFO - [0m07:58:54  1 of 2 START test not_null_stg_orders_CUSTOMER_ID .............................. [RUN]
[2025-09-22T07:58:54.883+0000] {subprocess.py:90} INFO - [0m07:58:54  2 of 2 START test not_null_stg_orders_ORDER_ID ................................. [RUN]
[2025-09-22T07:58:54.975+0000] {subprocess.py:90} INFO - [0m07:58:54  1 of 2 ERROR not_null_stg_orders_CUSTOMER_ID ................................... [[31mERROR[0m in 0.09s]
[2025-09-22T07:58:55.033+0000] {subprocess.py:90} INFO - [0m07:58:55  2 of 2 ERROR not_null_stg_orders_ORDER_ID ...................................... [[31mERROR[0m in 0.15s]
[2025-09-22T07:58:55.040+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.041+0000] {subprocess.py:90} INFO - [0m07:58:55  Finished running 2 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[2025-09-22T07:58:55.115+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.116+0000] {subprocess.py:90} INFO - [0m07:58:55  [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[2025-09-22T07:58:55.117+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.118+0000] {subprocess.py:90} INFO - [0m07:58:55  [31mFailure in test not_null_stg_orders_CUSTOMER_ID (models/ecom_staging/schema.yml)[0m
[2025-09-22T07:58:55.118+0000] {subprocess.py:90} INFO - [0m07:58:55    Database Error in test not_null_stg_orders_CUSTOMER_ID (models/ecom_staging/schema.yml)
[2025-09-22T07:58:55.119+0000] {subprocess.py:90} INFO -   HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
[2025-09-22T07:58:55.120+0000] {subprocess.py:90} INFO -    Code: 47. DB::Exception: Unknown expression identifier 'CUSTOMER_ID' in scope SELECT CUSTOMER_ID FROM ecom_db_staging.stg_orders WHERE CUSTOMER_ID IS NULL. Maybe you meant: ['customer_id']. (UNKNOWN_IDENTIFIER) (version 24.8.14.39 (official build))
[2025-09-22T07:58:55.121+0000] {subprocess.py:90} INFO -   compiled code at target/run/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_CUSTOMER_ID.sql
[2025-09-22T07:58:55.122+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.122+0000] {subprocess.py:90} INFO - [0m07:58:55    compiled code at target/compiled/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_CUSTOMER_ID.sql
[2025-09-22T07:58:55.123+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.124+0000] {subprocess.py:90} INFO - [0m07:58:55  [31mFailure in test not_null_stg_orders_ORDER_ID (models/ecom_staging/schema.yml)[0m
[2025-09-22T07:58:55.124+0000] {subprocess.py:90} INFO - [0m07:58:55    Database Error in test not_null_stg_orders_ORDER_ID (models/ecom_staging/schema.yml)
[2025-09-22T07:58:55.125+0000] {subprocess.py:90} INFO -   HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
[2025-09-22T07:58:55.126+0000] {subprocess.py:90} INFO -    Code: 47. DB::Exception: Unknown expression identifier 'ORDER_ID' in scope SELECT ORDER_ID FROM ecom_db_staging.stg_orders WHERE ORDER_ID IS NULL. Maybe you meant: ['order_id']. (UNKNOWN_IDENTIFIER) (version 24.8.14.39 (official build))
[2025-09-22T07:58:55.126+0000] {subprocess.py:90} INFO -   compiled code at target/run/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_ORDER_ID.sql
[2025-09-22T07:58:55.127+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.128+0000] {subprocess.py:90} INFO - [0m07:58:55    compiled code at target/compiled/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_ORDER_ID.sql
[2025-09-22T07:58:55.128+0000] {subprocess.py:90} INFO - [0m07:58:55
[2025-09-22T07:58:55.129+0000] {subprocess.py:90} INFO - [0m07:58:55  Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[2025-09-22T07:58:55.130+0000] {subprocess.py:90} INFO - [0m07:58:55  [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
[2025-09-22T07:58:55.130+0000] {subprocess.py:90} INFO - Summary of encountered deprecations:
[2025-09-22T07:58:55.131+0000] {subprocess.py:90} INFO - - ModelParamUsageDeprecation: 1 occurrence
[2025-09-22T07:58:55.131+0000] {subprocess.py:90} INFO - To see all deprecation instances instead of just the first occurrence of each,
[2025-09-22T07:58:55.132+0000] {subprocess.py:90} INFO - run command again with the `--show-all-deprecations` flag. You may also need to
[2025-09-22T07:58:55.133+0000] {subprocess.py:90} INFO - run with `--no-partial-parse` as some deprecations are only encountered during
[2025-09-22T07:58:55.133+0000] {subprocess.py:90} INFO - parsing.
[2025-09-22T07:58:56.917+0000] {subprocess.py:94} INFO - Command exited with return code 1
[2025-09-22T07:58:56.918+0000] {local.py:441} INFO - parsing.
[2025-09-22T07:58:56.933+0000] {local.py:196} WARNING - Artifact schema version: https://schemas.getdbt.com/dbt/manifest/v12.json is above dbt-ol supported version 7. This might cause errors.
[2025-09-22T07:58:56.934+0000] {local.py:196} WARNING - Artifact schema version: https://schemas.getdbt.com/dbt/run-results/v6.json is above dbt-ol supported version 5. This might cause errors.
[2025-09-22T07:58:56.944+0000] {local.py:547} INFO - Inlets: []
[2025-09-22T07:58:56.944+0000] {local.py:548} INFO - Outlets: []
[2025-09-22T07:58:56.945+0000] {local.py:772} INFO - Assigning inlets/outlets without DatasetAlias
[2025-09-22T07:58:56.946+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2025-09-22T07:58:57.082+0000] {local.py:253} ERROR - [0m07:58:53  Running with dbt=1.10.11
[0m07:58:53  [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m07:58:54  Registered adapter: clickhouse=1.9.3
[0m07:58:54  Found 8 models, 47 data tests, 8 sources, 597 macros
[0m07:58:54
[0m07:58:54  Concurrency: 4 threads (target='dev')
[0m07:58:54
[0m07:58:54  1 of 2 START test not_null_stg_orders_CUSTOMER_ID .............................. [RUN]
[0m07:58:54  2 of 2 START test not_null_stg_orders_ORDER_ID ................................. [RUN]
[0m07:58:54  1 of 2 ERROR not_null_stg_orders_CUSTOMER_ID ................................... [[31mERROR[0m in 0.09s]
[0m07:58:55  2 of 2 ERROR not_null_stg_orders_ORDER_ID ...................................... [[31mERROR[0m in 0.15s]
[0m07:58:55
[0m07:58:55  Finished running 2 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:58:55
[0m07:58:55  [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m07:58:55
[0m07:58:55  [31mFailure in test not_null_stg_orders_CUSTOMER_ID (models/ecom_staging/schema.yml)[0m
[0m07:58:55    Database Error in test not_null_stg_orders_CUSTOMER_ID (models/ecom_staging/schema.yml)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier 'CUSTOMER_ID' in scope SELECT CUSTOMER_ID FROM ecom_db_staging.stg_orders WHERE CUSTOMER_ID IS NULL. Maybe you meant: ['customer_id']. (UNKNOWN_IDENTIFIER) (version 24.8.14.39 (official build))
  compiled code at target/run/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_CUSTOMER_ID.sql
[0m07:58:55
[0m07:58:55    compiled code at target/compiled/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_CUSTOMER_ID.sql
[0m07:58:55
[0m07:58:55  [31mFailure in test not_null_stg_orders_ORDER_ID (models/ecom_staging/schema.yml)[0m
[0m07:58:55    Database Error in test not_null_stg_orders_ORDER_ID (models/ecom_staging/schema.yml)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier 'ORDER_ID' in scope SELECT ORDER_ID FROM ecom_db_staging.stg_orders WHERE ORDER_ID IS NULL. Maybe you meant: ['order_id']. (UNKNOWN_IDENTIFIER) (version 24.8.14.39 (official build))
  compiled code at target/run/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_ORDER_ID.sql
[0m07:58:55
[0m07:58:55    compiled code at target/compiled/ecom_staging/models/ecom_staging/schema.yml/not_null_stg_orders_ORDER_ID.sql
[0m07:58:55
[0m07:58:55  Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m07:58:55  [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[2025-09-22T07:58:57.090+0000] {virtualenv.py:131} INFO - Releasing virtualenv lock
[2025-09-22T07:58:57.091+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-09-22T07:58:57.129+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/virtualenv.py", line 144, in execute
    output = super().execute(context)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/local.py", line 1089, in execute
    result = self.build_and_run_cmd(context=context, cmd_flags=self.add_cmd_flags())
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/local.py", line 853, in build_and_run_cmd
    result = self.run_command(
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/virtualenv.py", line 129, in run_command
    return super().run_command(cmd, env, context, run_as_async=run_as_async, async_context=async_context)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/local.py", line 650, in run_command
    self.handle_exception(result)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/local.py", line 254, in handle_exception_subprocess
    raise AirflowException(f"dbt command failed. The command returned a non-zero exit code {result.exit_code}.")
airflow.exceptions.AirflowException: dbt command failed. The command returned a non-zero exit code 1.
[2025-09-22T07:58:57.132+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=dbt_staging, task_id=dbt_ecom.stg_orders.test, run_id=scheduled__2025-09-21T00:00:00+00:00, execution_date=20250921T000000, start_date=20250922T075816, end_date=20250922T075857
[2025-09-22T07:58:57.158+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 647 for task dbt_ecom.stg_orders.test (dbt command failed. The command returned a non-zero exit code 1.; 1057)
[2025-09-22T07:58:57.204+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 1
[2025-09-22T07:58:57.277+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-09-22T07:58:57.290+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-09-22T08:15:42.244+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-09-22T08:15:42.465+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dbt_staging.dbt_ecom.stg_orders.test scheduled__2025-09-21T00:00:00+00:00 [queued]>
[2025-09-22T08:15:42.481+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dbt_staging.dbt_ecom.stg_orders.test scheduled__2025-09-21T00:00:00+00:00 [queued]>
[2025-09-22T08:15:42.482+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-09-22T08:15:42.501+0000] {taskinstance.py:2330} INFO - Executing <Task(DbtTestVirtualenvOperator): dbt_ecom.stg_orders.test> on 2025-09-21 00:00:00+00:00
[2025-09-22T08:15:42.509+0000] {standard_task_runner.py:64} INFO - Started process 2569 to run task
[2025-09-22T08:15:42.513+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'dbt_staging', 'dbt_ecom.stg_orders.test', 'scheduled__2025-09-21T00:00:00+00:00', '--job-id', '658', '--raw', '--subdir', 'DAGS_FOLDER/dbt_staging.py', '--cfg-path', '/tmp/tmp9p4ftiaq']
[2025-09-22T08:15:42.517+0000] {standard_task_runner.py:91} INFO - Job 658: Subtask dbt_ecom.stg_orders.test
[2025-09-22T08:15:42.716+0000] {task_command.py:426} INFO - Running <TaskInstance: dbt_staging.dbt_ecom.stg_orders.test scheduled__2025-09-21T00:00:00+00:00 [running]> on host e95bde6b8d07
[2025-09-22T08:15:42.964+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='dbt_staging' AIRFLOW_CTX_TASK_ID='dbt_ecom.stg_orders.test' AIRFLOW_CTX_EXECUTION_DATE='2025-09-21T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-21T00:00:00+00:00'
[2025-09-22T08:15:42.966+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-09-22T08:15:42.981+0000] {baseoperator.py:400} WARNING - DbtTestVirtualenvOperator.execute cannot be called outside TaskInstance!
[2025-09-22T08:15:42.982+0000] {virtualenv.py:120} INFO - Checking if the virtualenv lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock exists
[2025-09-22T08:15:42.983+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:42.984+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:42.985+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:43.986+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:43.987+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:43.988+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:44.989+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:44.990+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:44.991+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:45.993+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:45.996+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:45.997+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:46.999+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:47.000+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:47.000+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:48.001+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:48.002+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:48.003+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:49.005+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:49.006+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:49.006+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:50.008+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:50.009+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:50.010+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:51.011+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:51.012+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:51.013+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:52.015+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:52.016+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:52.017+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:53.020+0000] {virtualenv.py:178} INFO - Checking for running process with PID 2496
[2025-09-22T08:15:53.022+0000] {virtualenv.py:181} INFO - Process 2496 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-22T08:15:53.023+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-22T08:15:54.025+0000] {virtualenv.py:126} INFO - Acquiring the virtualenv lock
[2025-09-22T08:15:54.026+0000] {virtualenv.py:195} INFO - Acquiring lock at /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock with pid 2569
[2025-09-22T08:15:54.027+0000] {virtualenv.py:153} INFO - Creating or updating the virtualenv at `/tmp/cosmos_venv_ecom
[2025-09-22T08:15:54.028+0000] {process_utils.py:183} INFO - Executing cmd: /home/***/.local/bin/python -m virtualenv /tmp/cosmos_venv_ecom --python=python3
[2025-09-22T08:15:54.030+0000] {process_utils.py:187} INFO - Output:
[2025-09-22T08:15:55.327+0000] {process_utils.py:191} INFO - created virtual environment CPython3.10.14.final.0-64 in 533ms
[2025-09-22T08:15:55.327+0000] {process_utils.py:191} INFO -   creator CPython3Posix(dest=/tmp/cosmos_venv_ecom, clear=False, no_vcs_ignore=False, global=False)
[2025-09-22T08:15:55.328+0000] {process_utils.py:191} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/***/.local/share/virtualenv)
[2025-09-22T08:15:55.329+0000] {process_utils.py:191} INFO -     added seed packages: MarkupSafe==3.0.2, PyYAML==6.0.2, agate==1.9.1, annotated_types==0.7.0, attrs==25.3.0, babel==2.17.0, certifi==2025.8.3, charset_normalizer==3.4.3, click==8.2.1, clickhouse_connect==0.8.18, clickhouse_driver==0.2.9, colorama==0.4.6, daff==1.4.2, dbt_adapters==1.16.7, dbt_clickhouse==1.9.3, dbt_common==1.30.0, dbt_core==1.10.11, dbt_extractor==0.6.0, dbt_protos==1.0.375, dbt_semantic_interfaces==0.9.0, deepdiff==8.6.1, idna==3.10, importlib_metadata==8.7.0, isodate==0.6.1, jinja2==3.1.6, jsonschema==4.25.1, jsonschema_specifications==2025.9.1, leather==0.4.0, lz4==4.4.4, mashumaro==3.14, more_itertools==10.8.0, msgpack==1.1.1, networkx==3.4.2, orderly_set==5.5.0, packaging==25.0, parsedatetime==2.6, pathspec==0.12.1, pip==25.2, protobuf==6.32.1, pydantic==2.11.7, pydantic_core==2.33.2, python_dateutil==2.9.0.post0, python_slugify==8.0.4, pytimeparse==1.1.8, pytz==2025.2, referencing==0.36.2, requests==2.32.5, rpds_py==0.27.1, setuptools==80.9.0, six==1.17.0, snowplow_tracker==1.1.0, sqlparse==0.5.3, text_unidecode==1.3, typing_extensions==4.15.0, typing_inspection==0.4.1, tzlocal==5.3.1, urllib3==2.5.0, wheel==0.45.1, zipp==3.23.0, zstandard==0.24.0
[2025-09-22T08:15:55.330+0000] {process_utils.py:191} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2025-09-22T08:15:55.414+0000] {process_utils.py:183} INFO - Executing cmd: /tmp/cosmos_venv_ecom/bin/pip install dbt-clickhouse
[2025-09-22T08:15:55.415+0000] {process_utils.py:187} INFO - Output:
[2025-09-22T08:15:56.626+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-clickhouse in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (1.9.3)
[2025-09-22T08:15:56.628+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-core>=1.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (1.10.11)
[2025-09-22T08:15:56.628+0000] {process_utils.py:191} INFO - Requirement already satisfied: clickhouse-connect>=0.6.22 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (0.8.18)
[2025-09-22T08:15:56.629+0000] {process_utils.py:191} INFO - Requirement already satisfied: clickhouse-driver>=0.2.6 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (0.2.9)
[2025-09-22T08:15:56.629+0000] {process_utils.py:191} INFO - Requirement already satisfied: setuptools>=0.69 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-clickhouse) (80.9.0)
[2025-09-22T08:15:56.633+0000] {process_utils.py:191} INFO - Requirement already satisfied: certifi in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (2025.8.3)
[2025-09-22T08:15:56.634+0000] {process_utils.py:191} INFO - Requirement already satisfied: urllib3>=1.26 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (2.5.0)
[2025-09-22T08:15:56.634+0000] {process_utils.py:191} INFO - Requirement already satisfied: pytz in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (2025.2)
[2025-09-22T08:15:56.634+0000] {process_utils.py:191} INFO - Requirement already satisfied: zstandard in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (0.24.0)
[2025-09-22T08:15:56.635+0000] {process_utils.py:191} INFO - Requirement already satisfied: lz4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-connect>=0.6.22->dbt-clickhouse) (4.4.4)
[2025-09-22T08:15:56.638+0000] {process_utils.py:191} INFO - Requirement already satisfied: tzlocal in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from clickhouse-driver>=0.2.6->dbt-clickhouse) (5.3.1)
[2025-09-22T08:15:56.641+0000] {process_utils.py:191} INFO - Requirement already satisfied: agate<1.10,>=1.7.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.9.1)
[2025-09-22T08:15:56.642+0000] {process_utils.py:191} INFO - Requirement already satisfied: Jinja2<4,>=3.1.3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (3.1.6)
[2025-09-22T08:15:56.643+0000] {process_utils.py:191} INFO - Requirement already satisfied: mashumaro<3.15,>=3.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from mashumaro[msgpack]<3.15,>=3.9->dbt-core>=1.9->dbt-clickhouse) (3.14)
[2025-09-22T08:15:56.644+0000] {process_utils.py:191} INFO - Requirement already satisfied: click<9.0,>=8.0.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (8.2.1)
[2025-09-22T08:15:56.644+0000] {process_utils.py:191} INFO - Requirement already satisfied: jsonschema<5.0,>=4.19.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (4.25.1)
[2025-09-22T08:15:56.645+0000] {process_utils.py:191} INFO - Requirement already satisfied: networkx<4.0,>=2.3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (3.4.2)
[2025-09-22T08:15:56.646+0000] {process_utils.py:191} INFO - Requirement already satisfied: protobuf<7.0,>=6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (6.32.1)
[2025-09-22T08:15:56.646+0000] {process_utils.py:191} INFO - Requirement already satisfied: requests<3.0.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (2.32.5)
[2025-09-22T08:15:56.647+0000] {process_utils.py:191} INFO - Requirement already satisfied: snowplow-tracker<2.0,>=1.0.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.1.0)
[2025-09-22T08:15:56.647+0000] {process_utils.py:191} INFO - Requirement already satisfied: pathspec<0.13,>=0.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.12.1)
[2025-09-22T08:15:56.648+0000] {process_utils.py:191} INFO - Requirement already satisfied: sqlparse<0.6.0,>=0.5.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.5.3)
[2025-09-22T08:15:56.648+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-extractor<=0.6,>=0.5.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.6.0)
[2025-09-22T08:15:56.649+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-semantic-interfaces<0.10,>=0.9.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (0.9.0)
[2025-09-22T08:15:56.650+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-common<2.0,>=1.27.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.30.0)
[2025-09-22T08:15:56.650+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-adapters<2.0,>=1.15.5 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.16.7)
[2025-09-22T08:15:56.652+0000] {process_utils.py:191} INFO - Requirement already satisfied: dbt-protos<2.0,>=1.0.346 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.0.375)
[2025-09-22T08:15:56.652+0000] {process_utils.py:191} INFO - Requirement already satisfied: pydantic<3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (2.11.7)
[2025-09-22T08:15:56.653+0000] {process_utils.py:191} INFO - Requirement already satisfied: packaging>20.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (25.0)
[2025-09-22T08:15:56.654+0000] {process_utils.py:191} INFO - Requirement already satisfied: pyyaml>=6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (6.0.2)
[2025-09-22T08:15:56.655+0000] {process_utils.py:191} INFO - Requirement already satisfied: daff>=1.3.46 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (1.4.2)
[2025-09-22T08:15:56.655+0000] {process_utils.py:191} INFO - Requirement already satisfied: typing-extensions>=4.4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-core>=1.9->dbt-clickhouse) (4.15.0)
[2025-09-22T08:15:56.659+0000] {process_utils.py:191} INFO - Requirement already satisfied: Babel>=2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (2.17.0)
[2025-09-22T08:15:56.659+0000] {process_utils.py:191} INFO - Requirement already satisfied: isodate>=0.5.4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (0.6.1)
[2025-09-22T08:15:56.660+0000] {process_utils.py:191} INFO - Requirement already satisfied: leather>=0.3.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (0.4.0)
[2025-09-22T08:15:56.660+0000] {process_utils.py:191} INFO - Requirement already satisfied: parsedatetime!=2.5,>=2.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (2.6)
[2025-09-22T08:15:56.661+0000] {process_utils.py:191} INFO - Requirement already satisfied: python-slugify>=1.2.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (8.0.4)
[2025-09-22T08:15:56.661+0000] {process_utils.py:191} INFO - Requirement already satisfied: pytimeparse>=1.1.5 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (1.1.8)
[2025-09-22T08:15:56.673+0000] {process_utils.py:191} INFO - Requirement already satisfied: colorama<0.5,>=0.3.9 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (0.4.6)
[2025-09-22T08:15:56.675+0000] {process_utils.py:191} INFO - Requirement already satisfied: deepdiff<9.0,>=7.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (8.6.1)
[2025-09-22T08:15:56.677+0000] {process_utils.py:191} INFO - Requirement already satisfied: python-dateutil<3.0,>=2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (2.9.0.post0)
[2025-09-22T08:15:56.683+0000] {process_utils.py:191} INFO - Requirement already satisfied: importlib-metadata<9,>=6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-semantic-interfaces<0.10,>=0.9.0->dbt-core>=1.9->dbt-clickhouse) (8.7.0)
[2025-09-22T08:15:56.684+0000] {process_utils.py:191} INFO - Requirement already satisfied: more-itertools<11.0,>=8.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from dbt-semantic-interfaces<0.10,>=0.9.0->dbt-core>=1.9->dbt-clickhouse) (10.8.0)
[2025-09-22T08:15:56.692+0000] {process_utils.py:191} INFO - Requirement already satisfied: orderly-set<6,>=5.4.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from deepdiff<9.0,>=7.0->dbt-common<2.0,>=1.27.0->dbt-core>=1.9->dbt-clickhouse) (5.5.0)
[2025-09-22T08:15:56.697+0000] {process_utils.py:191} INFO - Requirement already satisfied: zipp>=3.20 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from importlib-metadata<9,>=6.0->dbt-semantic-interfaces<0.10,>=0.9.0->dbt-core>=1.9->dbt-clickhouse) (3.23.0)
[2025-09-22T08:15:56.699+0000] {process_utils.py:191} INFO - Requirement already satisfied: six in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from isodate>=0.5.4->agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (1.17.0)
[2025-09-22T08:15:56.700+0000] {process_utils.py:191} INFO - Requirement already satisfied: MarkupSafe>=2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from Jinja2<4,>=3.1.3->dbt-core>=1.9->dbt-clickhouse) (3.0.2)
[2025-09-22T08:15:56.704+0000] {process_utils.py:191} INFO - Requirement already satisfied: attrs>=22.2.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (25.3.0)
[2025-09-22T08:15:56.705+0000] {process_utils.py:191} INFO - Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (2025.9.1)
[2025-09-22T08:15:56.705+0000] {process_utils.py:191} INFO - Requirement already satisfied: referencing>=0.28.4 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (0.36.2)
[2025-09-22T08:15:56.706+0000] {process_utils.py:191} INFO - Requirement already satisfied: rpds-py>=0.7.1 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from jsonschema<5.0,>=4.19.1->dbt-core>=1.9->dbt-clickhouse) (0.27.1)
[2025-09-22T08:15:56.713+0000] {process_utils.py:191} INFO - Requirement already satisfied: msgpack>=0.5.6 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from mashumaro[msgpack]<3.15,>=3.9->dbt-core>=1.9->dbt-clickhouse) (1.1.1)
[2025-09-22T08:15:56.731+0000] {process_utils.py:191} INFO - Requirement already satisfied: annotated-types>=0.6.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from pydantic<3->dbt-core>=1.9->dbt-clickhouse) (0.7.0)
[2025-09-22T08:15:56.731+0000] {process_utils.py:191} INFO - Requirement already satisfied: pydantic-core==2.33.2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from pydantic<3->dbt-core>=1.9->dbt-clickhouse) (2.33.2)
[2025-09-22T08:15:56.733+0000] {process_utils.py:191} INFO - Requirement already satisfied: typing-inspection>=0.4.0 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from pydantic<3->dbt-core>=1.9->dbt-clickhouse) (0.4.1)
[2025-09-22T08:15:56.740+0000] {process_utils.py:191} INFO - Requirement already satisfied: charset_normalizer<4,>=2 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from requests<3.0.0->dbt-core>=1.9->dbt-clickhouse) (3.4.3)
[2025-09-22T08:15:56.741+0000] {process_utils.py:191} INFO - Requirement already satisfied: idna<4,>=2.5 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from requests<3.0.0->dbt-core>=1.9->dbt-clickhouse) (3.10)
[2025-09-22T08:15:56.782+0000] {process_utils.py:191} INFO - Requirement already satisfied: text-unidecode>=1.3 in /tmp/cosmos_venv_ecom/lib/python3.10/site-packages (from python-slugify>=1.2.1->agate<1.10,>=1.7.0->dbt-core>=1.9->dbt-clickhouse) (1.3)
[2025-09-22T08:15:56.908+0000] {local.py:470} INFO - Cloning project to writable temp directory /tmp/tmpk_k8lwjw from /opt/airflow/dags/dbt/ecom_staging
[2025-09-22T08:15:56.920+0000] {local.py:490} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/dbt_staging__dbt_ecom/target/partial_parse.msgpack
[2025-09-22T08:15:56.931+0000] {config.py:362} INFO - Using user-supplied profiles.yml at /opt/airflow/dags/dbt/profiles.yml
[2025-09-22T08:15:56.942+0000] {virtualenv.py:99} INFO - Using Python binary from virtualenv: /tmp/cosmos_venv_ecom/bin/python
[2025-09-22T08:15:56.943+0000] {local.py:434} INFO - Trying to run the command:
 ['/tmp/cosmos_venv_ecom/bin/dbt', 'deps', '--project-dir', '/tmp/tmpk_k8lwjw', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
From /tmp/tmpk_k8lwjw
[2025-09-22T08:15:56.944+0000] {subprocess.py:56} INFO - Tmp dir root location: 
 /tmp
[2025-09-22T08:15:56.944+0000] {subprocess.py:69} INFO - Running command: ['/tmp/cosmos_venv_ecom/bin/dbt', 'deps', '--project-dir', '/tmp/tmpk_k8lwjw', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
[2025-09-22T08:15:56.955+0000] {subprocess.py:80} INFO - Command output:
[2025-09-22T08:15:59.383+0000] {subprocess.py:90} INFO - [0m08:15:59  Running with dbt=1.10.11
[2025-09-22T08:16:00.231+0000] {subprocess.py:90} INFO - [0m08:16:00  Installing dbt-labs/dbt_utils
[2025-09-22T08:16:00.920+0000] {subprocess.py:90} INFO - [0m08:16:00  Installed from version 1.3.0
[2025-09-22T08:16:00.921+0000] {subprocess.py:90} INFO - [0m08:16:00  Updated version available: 1.3.1
[2025-09-22T08:16:00.922+0000] {subprocess.py:90} INFO - [0m08:16:00
[2025-09-22T08:16:00.924+0000] {subprocess.py:90} INFO - [0m08:16:00  Updates available for packages: ['dbt-labs/dbt_utils']
[2025-09-22T08:16:00.925+0000] {subprocess.py:90} INFO - Update your versions in packages.yml, then run dbt deps
[2025-09-22T08:16:02.716+0000] {subprocess.py:94} INFO - Command exited with return code 0
[2025-09-22T08:16:02.717+0000] {local.py:441} INFO - Update your versions in packages.yml, then run dbt deps
[2025-09-22T08:16:02.717+0000] {virtualenv.py:99} INFO - Using Python binary from virtualenv: /tmp/cosmos_venv_ecom/bin/python
[2025-09-22T08:16:02.718+0000] {local.py:434} INFO - Trying to run the command:
 ['/tmp/cosmos_venv_ecom/bin/dbt', 'test', '--models', 'stg_orders', '--project-dir', '/tmp/tmpk_k8lwjw', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
From /tmp/tmpk_k8lwjw
[2025-09-22T08:16:02.718+0000] {subprocess.py:56} INFO - Tmp dir root location: 
 /tmp
[2025-09-22T08:16:02.718+0000] {subprocess.py:69} INFO - Running command: ['/tmp/cosmos_venv_ecom/bin/dbt', 'test', '--models', 'stg_orders', '--project-dir', '/tmp/tmpk_k8lwjw', '--profiles-dir', '/opt/***/dags/dbt', '--profile', 'ecom_staging', '--target', 'dev']
[2025-09-22T08:16:02.735+0000] {subprocess.py:80} INFO - Command output:
[2025-09-22T08:16:05.143+0000] {subprocess.py:90} INFO - [0m08:16:05  Running with dbt=1.10.11
[2025-09-22T08:16:05.145+0000] {subprocess.py:90} INFO - [0m08:16:05  [[33mWARNING[0m]: Deprecated functionality
[2025-09-22T08:16:05.146+0000] {subprocess.py:90} INFO - Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
[2025-09-22T08:16:05.146+0000] {subprocess.py:90} INFO - `-s`.
[2025-09-22T08:16:05.504+0000] {subprocess.py:90} INFO - [0m08:16:05  Registered adapter: clickhouse=1.9.3
[2025-09-22T08:16:06.407+0000] {subprocess.py:90} INFO - [0m08:16:06  Found 8 models, 46 data tests, 8 sources, 597 macros
[2025-09-22T08:16:06.410+0000] {subprocess.py:90} INFO - [0m08:16:06
[2025-09-22T08:16:06.411+0000] {subprocess.py:90} INFO - [0m08:16:06  Concurrency: 4 threads (target='dev')
[2025-09-22T08:16:06.412+0000] {subprocess.py:90} INFO - [0m08:16:06
[2025-09-22T08:16:06.548+0000] {subprocess.py:90} INFO - [0m08:16:06  1 of 2 START test not_null_stg_orders_customer_id .............................. [RUN]
[2025-09-22T08:16:06.570+0000] {subprocess.py:90} INFO - [0m08:16:06  2 of 2 START test not_null_stg_orders_order_id ................................. [RUN]
[2025-09-22T08:16:06.617+0000] {subprocess.py:90} INFO - [0m08:16:06  1 of 2 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.07s]
[2025-09-22T08:16:06.676+0000] {subprocess.py:90} INFO - [0m08:16:06  2 of 2 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.10s]
[2025-09-22T08:16:06.681+0000] {subprocess.py:90} INFO - [0m08:16:06
[2025-09-22T08:16:06.682+0000] {subprocess.py:90} INFO - [0m08:16:06  Finished running 2 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[2025-09-22T08:16:06.739+0000] {subprocess.py:90} INFO - [0m08:16:06
[2025-09-22T08:16:06.740+0000] {subprocess.py:90} INFO - [0m08:16:06  [32mCompleted successfully[0m
[2025-09-22T08:16:06.741+0000] {subprocess.py:90} INFO - [0m08:16:06
[2025-09-22T08:16:06.742+0000] {subprocess.py:90} INFO - [0m08:16:06  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[2025-09-22T08:16:06.743+0000] {subprocess.py:90} INFO - [0m08:16:06  [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
[2025-09-22T08:16:06.743+0000] {subprocess.py:90} INFO - Summary of encountered deprecations:
[2025-09-22T08:16:06.744+0000] {subprocess.py:90} INFO - - ModelParamUsageDeprecation: 1 occurrence
[2025-09-22T08:16:06.744+0000] {subprocess.py:90} INFO - To see all deprecation instances instead of just the first occurrence of each,
[2025-09-22T08:16:06.745+0000] {subprocess.py:90} INFO - run command again with the `--show-all-deprecations` flag. You may also need to
[2025-09-22T08:16:06.745+0000] {subprocess.py:90} INFO - run with `--no-partial-parse` as some deprecations are only encountered during
[2025-09-22T08:16:06.746+0000] {subprocess.py:90} INFO - parsing.
[2025-09-22T08:16:08.416+0000] {subprocess.py:94} INFO - Command exited with return code 0
[2025-09-22T08:16:08.420+0000] {local.py:441} INFO - parsing.
[2025-09-22T08:16:08.437+0000] {local.py:196} WARNING - Artifact schema version: https://schemas.getdbt.com/dbt/manifest/v12.json is above dbt-ol supported version 7. This might cause errors.
[2025-09-22T08:16:08.438+0000] {local.py:196} WARNING - Artifact schema version: https://schemas.getdbt.com/dbt/run-results/v6.json is above dbt-ol supported version 5. This might cause errors.
[2025-09-22T08:16:08.445+0000] {local.py:547} INFO - Inlets: []
[2025-09-22T08:16:08.445+0000] {local.py:548} INFO - Outlets: []
[2025-09-22T08:16:08.446+0000] {local.py:772} INFO - Assigning inlets/outlets without DatasetAlias
[2025-09-22T08:16:08.447+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2025-09-22T08:16:08.623+0000] {virtualenv.py:131} INFO - Releasing virtualenv lock
[2025-09-22T08:16:08.624+0000] {virtualenv.py:145} INFO - None
[2025-09-22T08:16:08.624+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-09-22T08:16:08.662+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=dbt_staging, task_id=dbt_ecom.stg_orders.test, run_id=scheduled__2025-09-21T00:00:00+00:00, execution_date=20250921T000000, start_date=20250922T081542, end_date=20250922T081608
[2025-09-22T08:16:08.723+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2025-09-22T08:16:08.789+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-09-22T08:16:08.792+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
