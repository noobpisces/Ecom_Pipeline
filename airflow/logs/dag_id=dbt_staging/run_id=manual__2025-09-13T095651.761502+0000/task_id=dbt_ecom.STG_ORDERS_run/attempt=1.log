[2025-09-13T09:56:54.682+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-09-13T09:56:55.215+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dbt_staging.dbt_ecom.STG_ORDERS_run manual__2025-09-13T09:56:51.761502+00:00 [queued]>
[2025-09-13T09:56:55.233+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dbt_staging.dbt_ecom.STG_ORDERS_run manual__2025-09-13T09:56:51.761502+00:00 [queued]>
[2025-09-13T09:56:55.235+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-09-13T09:56:55.326+0000] {taskinstance.py:2330} INFO - Executing <Task(DbtRunVirtualenvOperator): dbt_ecom.STG_ORDERS_run> on 2025-09-13 09:56:51.761502+00:00
[2025-09-13T09:56:55.336+0000] {standard_task_runner.py:64} INFO - Started process 8719 to run task
[2025-09-13T09:56:55.348+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'dbt_staging', 'dbt_ecom.STG_ORDERS_run', 'manual__2025-09-13T09:56:51.761502+00:00', '--job-id', '258', '--raw', '--subdir', 'DAGS_FOLDER/dbt_staging.py', '--cfg-path', '/tmp/tmpqqs30ypc']
[2025-09-13T09:56:55.354+0000] {standard_task_runner.py:91} INFO - Job 258: Subtask dbt_ecom.STG_ORDERS_run
[2025-09-13T09:56:55.746+0000] {task_command.py:426} INFO - Running <TaskInstance: dbt_staging.dbt_ecom.STG_ORDERS_run manual__2025-09-13T09:56:51.761502+00:00 [running]> on host e95bde6b8d07
[2025-09-13T09:56:56.349+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='dbt_staging' AIRFLOW_CTX_TASK_ID='dbt_ecom.STG_ORDERS_run' AIRFLOW_CTX_EXECUTION_DATE='2025-09-13T09:56:51.761502+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-09-13T09:56:51.761502+00:00'
[2025-09-13T09:56:56.351+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-09-13T09:56:56.371+0000] {virtualenv.py:120} INFO - Checking if the virtualenv lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock exists
[2025-09-13T09:56:56.372+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:56:56.373+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:56:56.374+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:56:57.375+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:56:57.376+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:56:57.376+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:56:58.378+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:56:58.379+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:56:58.379+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:56:59.381+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:56:59.382+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:56:59.383+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:00.384+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:00.386+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:00.387+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:01.389+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:01.390+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:01.390+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:02.392+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:02.392+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:02.393+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:03.395+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:03.396+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:03.396+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:04.398+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:04.399+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:04.399+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:05.401+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:05.402+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:05.403+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:06.405+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:06.406+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:06.407+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:07.407+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:07.408+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:07.409+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:08.410+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:08.411+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:08.411+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:09.413+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:09.414+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:09.415+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:10.417+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8713
[2025-09-13T09:57:10.418+0000] {virtualenv.py:181} INFO - Process 8713 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:10.418+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:11.420+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:11.421+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:11.422+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:12.424+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:12.424+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:12.425+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:13.426+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:13.427+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:13.428+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:14.429+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:14.429+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:14.430+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:15.431+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:15.432+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:15.433+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:16.434+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:16.435+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:16.435+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:17.437+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:17.438+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:17.438+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:18.440+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:18.441+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:18.441+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:19.443+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:19.444+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:19.444+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:20.446+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:20.447+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:20.448+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:21.449+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:21.450+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:21.451+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:22.453+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:22.453+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:22.454+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:23.455+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:23.456+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:23.457+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:24.458+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8714
[2025-09-13T09:57:24.459+0000] {virtualenv.py:181} INFO - Process 8714 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:24.459+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:25.461+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:25.462+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:25.463+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:26.465+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:26.466+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:26.466+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:27.468+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:27.468+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:27.469+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:28.471+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:28.471+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:28.472+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:29.474+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:29.475+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:29.475+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:30.477+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:30.478+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:30.479+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:31.480+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:31.481+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:31.481+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:32.483+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:32.484+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:32.485+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:33.486+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:33.487+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:33.488+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:34.490+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:34.491+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:34.492+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:35.494+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:35.496+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:35.497+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:36.498+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:36.499+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:36.500+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:37.500+0000] {virtualenv.py:178} INFO - Checking for running process with PID 8717
[2025-09-13T09:57:37.501+0000] {virtualenv.py:181} INFO - Process 8717 running: True and has the lock /tmp/cosmos_venv_ecom/cosmos_virtualenv.lock.
[2025-09-13T09:57:37.502+0000] {virtualenv.py:122} INFO - Waiting for virtualenv lock to be released
[2025-09-13T09:57:38.503+0000] {virtualenv.py:131} INFO - Releasing virtualenv lock
[2025-09-13T09:57:38.507+0000] {virtualenv.py:210} WARNING - Lockfile owned by process of pid 8718, while operator has pid 8719
[2025-09-13T09:57:38.515+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-09-13T09:57:38.518+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/virtualenv.py", line 144, in execute
    output = super().execute(context)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/base.py", line 310, in execute
    self.build_and_run_cmd(context=context, cmd_flags=self.add_cmd_flags())
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/local.py", line 853, in build_and_run_cmd
    result = self.run_command(
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/virtualenv.py", line 121, in run_command
    while not self._is_lock_available() and self.max_retries_lock:
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/virtualenv.py", line 52, in wrapper
    return method(operator, *args)
  File "/home/airflow/.local/lib/python3.10/site-packages/cosmos/operators/virtualenv.py", line 177, in _is_lock_available
    pid = int(lf.read())
ValueError: invalid literal for int() with base 10: ''
[2025-09-13T09:57:38.587+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=dbt_staging, task_id=dbt_ecom.STG_ORDERS_run, run_id=manual__2025-09-13T09:56:51.761502+00:00, execution_date=20250913T095651, start_date=20250913T095655, end_date=20250913T095738
[2025-09-13T09:57:38.620+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 258 for task dbt_ecom.STG_ORDERS_run (invalid literal for int() with base 10: ''; 8719)
[2025-09-13T09:57:38.657+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 1
[2025-09-13T09:57:38.741+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-09-13T09:57:38.743+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
